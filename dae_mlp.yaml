!obj:pylearn2.train.Train {
        "dataset": !pkl: "${PYLEARN2_DATA_PATH}/sergent/train.pkl",
        "model": !obj:pylearn2.models.mlp.MLP {
            "batch_size": 16,
            "layers": [
                 !obj:pylearn2.models.mlp.PretrainedLayer {
                     "layer_name": 'h1',
                     "layer_content": !pkl: "sparserf_example.pkl",
                 },
                 !obj:pylearn2.models.mlp.PretrainedLayer {
                     "layer_name": 'h2',
                     "layer_content": !pkl: "/raid/vprasad/NN-Research/dae_l2.pkl",
                 },
                 !obj:pylearn2.models.mlp.Softmax {
                     "layer_name": 'y',
                     "n_classes": 1,
                     "irange": .005
                 }
                ],
            "nvis": 1024
        },
        "algorithm": !obj:pylearn2.training_algorithms.sgd.SGD {
            "learning_rate": .05,
            "learning_rule": !obj:pylearn2.training_algorithms.learning_rule.Momentum {
                "init_momentum": .5,
            },
            "monitoring_dataset":
                {
                    'monitor'  : !pkl: "${PYLEARN2_DATA_PATH}/sergent/train.pkl",
                },        
            "cost": !obj:pylearn2.costs.mlp.Default {},
            "termination_criterion": !obj:pylearn2.termination_criteria.And {
                "criteria": [
                    !obj:pylearn2.termination_criteria.EpochCounter {
                        "max_epochs": 50 
                    }
                ]
            },
            "update_callbacks": !obj:pylearn2.training_algorithms.sgd.ExponentialDecay {
            "decay_factor": 1.00004,
            "min_lr": .000001
        }
    },
    "extensions": [
        !obj:pylearn2.training_algorithms.learning_rule.MomentumAdjustor {
            "start": 1,
            "saturate": 250,
            "final_momentum": .7
        }
    ],
    "save_path": 'final.pkl',
    "save_freq": 50
}
